var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function i(e){e.forEach(t)}function a(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n||null)}function l(e){e.parentNode.removeChild(e)}function r(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function c(){return p(" ")}function f(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function g(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function m(e){return""===e?null:+e}function d(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function $(e,t){e.value=null==t?"":t}function x(e,t,n,i){e.style.setProperty(t,n,i?"important":"")}let h;function v(e){h=e}function S(){if(!h)throw new Error("Function called outside component initialization");return h}const w=[],O=[],y=[],C=[],T=Promise.resolve();let R=!1;function P(e){y.push(e)}function _(e){C.push(e)}let I=!1;const L=new Set;function M(){if(!I){I=!0;do{for(let e=0;e<w.length;e+=1){const t=w[e];v(t),z(t.$$)}for(v(null),w.length=0;O.length;)O.pop()();for(let e=0;e<y.length;e+=1){const t=y[e];L.has(t)||(L.add(t),t())}y.length=0}while(w.length);for(;C.length;)C.pop()();R=!1,I=!1,L.clear()}}function z(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(P)}}const b=new Set;function E(e,t){e&&e.i&&(b.delete(e),e.i(t))}function V(e,t,n,i){if(e&&e.o){if(b.has(e))return;b.add(e),undefined.c.push((()=>{b.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}}function k(e,t,n){const i=e.$$.props[t];void 0!==i&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function q(e){e&&e.c()}function D(e,n,o,s){const{fragment:u,on_mount:l,on_destroy:r,after_update:p}=e.$$;u&&u.m(n,o),s||P((()=>{const n=l.map(t).filter(a);r?r.push(...n):i(n),e.$$.on_mount=[]})),p.forEach(P)}function F(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function B(e,t){-1===e.$$.dirty[0]&&(w.push(e),R||(R=!0,T.then(M)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function U(t,a,o,s,u,r,p=[-1]){const c=h;v(t);const f=t.$$={fragment:null,ctx:null,props:r,update:e,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:a.context||[]),callbacks:n(),dirty:p,skip_bound:!1};let g=!1;if(f.ctx=o?o(t,a.props||{},((e,n,...i)=>{const a=i.length?i[0]:n;return f.ctx&&u(f.ctx[e],f.ctx[e]=a)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](a),g&&B(t,e)),n})):[],f.update(),g=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),a.target){if(a.hydrate){const e=function(e){return Array.from(e.childNodes)}(a.target);f.fragment&&f.fragment.l(e),e.forEach(l)}else f.fragment&&f.fragment.c();a.intro&&E(t.$$.fragment),D(t,a.target,a.anchor,a.customElement),M()}v(c)}class N{$destroy(){F(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function A(t){let n,a,o,x,h,v,S,w,O,y;return{c(){n=r("div"),a=r("div"),o=p(t[1]),x=c(),h=r("div"),v=r("input"),S=c(),w=r("input"),g(a,"class","name"),g(v,"type","number"),g(v,"min",t[2]),g(v,"max",t[3]),g(w,"type","number"),g(w,"min",t[2]),g(w,"max",t[3]),g(n,"class","holder")},m(e,i){u(e,n,i),s(n,a),s(a,o),s(n,x),s(n,h),s(h,v),$(v,t[0][0]),s(h,S),s(h,w),$(w,t[0][1]),O||(y=[f(v,"input",t[5]),f(w,"input",t[6])],O=!0)},p(e,[t]){2&t&&d(o,e[1]),4&t&&g(v,"min",e[2]),8&t&&g(v,"max",e[3]),1&t&&m(v.value)!==e[0][0]&&$(v,e[0][0]),4&t&&g(w,"min",e[2]),8&t&&g(w,"max",e[3]),1&t&&m(w.value)!==e[0][1]&&$(w,e[0][1])},i:e,o:e,d(e){e&&l(n),O=!1,i(y)}}}function X(e,t,n){let{name:i}=t,{res:a}=t,{min:o}=t,{max:s}=t,{defaultVal:u}=t;return a||(a=u||[0,0]),e.$$set=e=>{"name"in e&&n(1,i=e.name),"res"in e&&n(0,a=e.res),"min"in e&&n(2,o=e.min),"max"in e&&n(3,s=e.max),"defaultVal"in e&&n(4,u=e.defaultVal)},[a,i,o,s,u,function(){a[0]=m(this.value),n(0,a)},function(){a[1]=m(this.value),n(0,a)}]}class j extends N{constructor(e){super(),U(this,e,X,A,o,{name:1,res:0,min:2,max:3,defaultVal:4})}}function H(e){let t,n,i,a,o,f,m,$,x,h;function v(t){e[3](t)}let S={name:"min"};function w(t){e[4](t)}void 0!==e[0].min&&(S.res=e[0].min),o=new j({props:S}),O.push((()=>k(o,"res",v)));let y={name:"max"};return void 0!==e[0].max&&(y.res=e[0].max),$=new j({props:y}),O.push((()=>k($,"res",w))),{c(){t=r("div"),n=p(e[1]),i=c(),a=r("div"),q(o.$$.fragment),m=c(),q($.$$.fragment),g(a,"class","block")},m(e,l){u(e,t,l),s(t,n),s(t,i),s(t,a),D(o,a,null),s(a,m),D($,a,null),h=!0},p(e,[t]){(!h||2&t)&&d(n,e[1]);const i={};!f&&1&t&&(f=!0,i.res=e[0].min,_((()=>f=!1))),o.$set(i);const a={};!x&&1&t&&(x=!0,a.res=e[0].max,_((()=>x=!1))),$.$set(a)},i(e){h||(E(o.$$.fragment,e),E($.$$.fragment,e),h=!0)},o(e){V(o.$$.fragment,e),V($.$$.fragment,e),h=!1},d(e){e&&l(t),F(o),F($)}}}function J(e,t,n){let{name:i}=t,{res:a}=t,{defaultVal:o}=t;return a||(a=o||{}),e.$$set=e=>{"name"in e&&n(1,i=e.name),"res"in e&&n(0,a=e.res),"defaultVal"in e&&n(2,o=e.defaultVal)},[a,i,o,function(t){e.$$.not_equal(a.min,t)&&(a.min=t,n(0,a))},function(t){e.$$.not_equal(a.max,t)&&(a.max=t,n(0,a))}]}class Y extends N{constructor(e){super(),U(this,e,J,H,o,{name:1,res:0,defaultVal:2})}}function G(t){let n,a,o,x,h,v,S,w,O,y,C,T;return{c(){n=r("div"),a=r("div"),o=p(t[2]),x=c(),h=r("div"),v=r("input"),w=p(" → "),O=r("input"),g(a,"class","name"),g(v,"type","number"),g(v,"min",S=t[3]||void 0),g(v,"max",t[1]),g(v,"class","svelte-16nso2u"),g(O,"type","number"),g(O,"min",t[0]),g(O,"max",y=t[4]||void 0),g(O,"class","svelte-16nso2u"),g(n,"class","holder")},m(e,i){u(e,n,i),s(n,a),s(a,o),s(n,x),s(n,h),s(h,v),$(v,t[0]),s(h,w),s(h,O),$(O,t[1]),C||(T=[f(v,"input",t[5]),f(O,"input",t[6])],C=!0)},p(e,[t]){4&t&&d(o,e[2]),8&t&&S!==(S=e[3]||void 0)&&g(v,"min",S),2&t&&g(v,"max",e[1]),1&t&&m(v.value)!==e[0]&&$(v,e[0]),1&t&&g(O,"min",e[0]),16&t&&y!==(y=e[4]||void 0)&&g(O,"max",y),2&t&&m(O.value)!==e[1]&&$(O,e[1])},i:e,o:e,d(e){e&&l(n),C=!1,i(T)}}}function W(e,t,n){let{name:i}=t,{min:a}=t,{max:o}=t,{resMin:s}=t,{resMax:u}=t;return s||(s=0),u||(u=s),e.$$set=e=>{"name"in e&&n(2,i=e.name),"min"in e&&n(3,a=e.min),"max"in e&&n(4,o=e.max),"resMin"in e&&n(0,s=e.resMin),"resMax"in e&&n(1,u=e.resMax)},[s,u,i,a,o,function(){s=m(this.value),n(0,s)},function(){u=m(this.value),n(1,u)}]}class K extends N{constructor(e){super(),U(this,e,W,G,o,{name:2,min:3,max:4,resMin:0,resMax:1})}}function Q(t){let n,i,a,o,f,m,$,x,h,v,S,w,O,y,C,T;return{c(){n=p(t[0]),i=c(),a=r("div"),o=r("div"),o.textContent="Intensity Encoding",f=c(),m=r("select"),$=r("option"),$.textContent="Auto",x=r("option"),x.textContent="sRGB",h=r("option"),h.textContent="Linear",v=c(),S=r("div"),w=r("div"),w.textContent="Bit Depth",O=c(),y=r("select"),C=r("option"),C.textContent="Auto",T=r("option"),T.textContent="16",g(o,"class","name"),$.__value="Auto",$.value=$.__value,x.__value="sRGB",x.value=x.__value,h.__value="Linear",h.value=h.__value,g(m,"class","svelte-os8uuf"),g(a,"class","holder"),g(w,"class","name"),C.__value="Auto",C.value=C.__value,T.__value="16",T.value=T.__value,g(y,"class","svelte-os8uuf"),g(S,"class","holder")},m(e,t){u(e,n,t),u(e,i,t),u(e,a,t),s(a,o),s(a,f),s(a,m),s(m,$),s(m,x),s(m,h),u(e,v,t),u(e,S,t),s(S,w),s(S,O),s(S,y),s(y,C),s(y,T)},p(e,[t]){1&t&&d(n,e[0])},i:e,o:e,d(e){e&&l(n),e&&l(i),e&&l(a),e&&l(v),e&&l(S)}}}function Z(e,t,n){let{name:i}=t;return e.$$set=e=>{"name"in e&&n(0,i=e.name)},[i]}class ee extends N{constructor(e){super(),U(this,e,Z,Q,o,{name:0})}}function te(t){let n,i,a,o,m,h,v,S,w=t[1]+(t[2](t[0])?"":" (Malformed Format String)");return{c(){n=r("div"),i=r("div"),a=p(w),o=c(),m=r("div"),h=r("input"),g(i,"class","name"),g(n,"class","holder"),g(h,"type","text"),x(h,"background-color",t[2](t[0])?"#fff":"#a44"),g(h,"class","svelte-fdbe0n"),g(m,"class","holder")},m(e,l){u(e,n,l),s(n,i),s(i,a),u(e,o,l),u(e,m,l),s(m,h),$(h,t[0]),v||(S=f(h,"input",t[4]),v=!0)},p(e,[t]){3&t&&w!==(w=e[1]+(e[2](e[0])?"":" (Malformed Format String)"))&&d(a,w),1&t&&x(h,"background-color",e[2](e[0])?"#fff":"#a44"),1&t&&h.value!==e[0]&&$(h,e[0])},i:e,o:e,d(e){e&&l(n),e&&l(o),e&&l(m),v=!1,S()}}}function ne(e,t,n){let{name:i}=t,{res:a}=t,{defaultVal:o}=t;a||(a=o||"");return e.$$set=e=>{"name"in e&&n(1,i=e.name),"res"in e&&n(0,a=e.res),"defaultVal"in e&&n(3,o=e.defaultVal)},[a,i,e=>-1!=e.search(/\{x[0-9]*\}/)&&-1!=e.search(/\{y[0-9]*\}/)&&-1!=e.search(/\{z[0-9]*\}/),o,function(){a=this.value,n(0,a)}]}class ie extends N{constructor(e){super(),U(this,e,ne,te,o,{name:1,res:0,defaultVal:3})}}function ae(e){let t,n,i,a,o,p,f,m,d,$,x,h,v,S,w,y,C,T,R,P,I,L,M,z,b;function B(t){e[1](t)}let U={name:"Input Format",defaultVal:"https://spkit.org/datasets/remapped/{x3}_{y3}_{z3}.hgt"};function N(t){e[2](t)}void 0!==e[0].DatasetConfig.InputURIFormat&&(U.res=e[0].DatasetConfig.InputURIFormat),n=new ie({props:U}),O.push((()=>k(n,"res",B)));let A={name:"Output Format",defaultVal:"./{x3}_{y3}_{z3}.png"};function X(t){e[3](t)}void 0!==e[0].DatasetConfig.OutputURIFormat&&(A.res=e[0].DatasetConfig.OutputURIFormat),o=new ie({props:A}),O.push((()=>k(o,"res",N)));let H={name:"Output Pixel Range",defaultVal:{min:[0,36030],max:[432360,144120]}};function J(t){e[4](t)}void 0!==e[0].SpatialConfig.OutputPixelRange&&(H.res=e[0].SpatialConfig.OutputPixelRange),m=new Y({props:H}),O.push((()=>k(m,"res",X)));let G={name:"Output Tile Size",defaultVal:[512,512],min:"0"};function W(t){e[5](t)}void 0!==e[0].SpatialConfig.OutputTileSize&&(G.res=e[0].SpatialConfig.OutputTileSize),x=new j({props:G}),O.push((()=>k(x,"res",J)));let Q={name:"Input Tile Size",defaultVal:[1201,1201],min:"0"};function Z(t){e[6](t)}void 0!==e[0].SpatialConfig.InputTileSize&&(Q.res=e[0].SpatialConfig.InputTileSize),S=new j({props:Q}),O.push((()=>k(S,"res",W)));let te={name:"Output → Input Pixel Ratio"};function ne(t){e[7](t)}function ae(t){e[8](t)}void 0!==e[0].SpatialConfig.OutputToInputPixelRatio&&(te.res=e[0].SpatialConfig.OutputToInputPixelRatio),C=new j({props:te}),O.push((()=>k(C,"res",Z)));let oe={name:"Output Level Range",min:"0",max:"32"};return void 0!==e[0].SpatialConfig.BeginOutputLevel&&(oe.resMin=e[0].SpatialConfig.BeginOutputLevel),void 0!==e[0].SpatialConfig.EndOutputLevel&&(oe.resMax=e[0].SpatialConfig.EndOutputLevel),P=new K({props:oe}),O.push((()=>k(P,"resMin",ne))),O.push((()=>k(P,"resMax",ae))),z=new ee({props:{name:"Input Encoding"}}),{c(){t=r("div"),q(n.$$.fragment),a=c(),q(o.$$.fragment),f=c(),q(m.$$.fragment),$=c(),q(x.$$.fragment),v=c(),q(S.$$.fragment),y=c(),q(C.$$.fragment),R=c(),q(P.$$.fragment),M=c(),q(z.$$.fragment),g(t,"class","svelte-1jabcyx")},m(e,i){u(e,t,i),D(n,t,null),s(t,a),D(o,t,null),s(t,f),D(m,t,null),s(t,$),D(x,t,null),s(t,v),D(S,t,null),s(t,y),D(C,t,null),s(t,R),D(P,t,null),s(t,M),D(z,t,null),b=!0},p(e,[t]){const a={};!i&&1&t&&(i=!0,a.res=e[0].DatasetConfig.InputURIFormat,_((()=>i=!1))),n.$set(a);const s={};!p&&1&t&&(p=!0,s.res=e[0].DatasetConfig.OutputURIFormat,_((()=>p=!1))),o.$set(s);const u={};!d&&1&t&&(d=!0,u.res=e[0].SpatialConfig.OutputPixelRange,_((()=>d=!1))),m.$set(u);const l={};!h&&1&t&&(h=!0,l.res=e[0].SpatialConfig.OutputTileSize,_((()=>h=!1))),x.$set(l);const r={};!w&&1&t&&(w=!0,r.res=e[0].SpatialConfig.InputTileSize,_((()=>w=!1))),S.$set(r);const c={};!T&&1&t&&(T=!0,c.res=e[0].SpatialConfig.OutputToInputPixelRatio,_((()=>T=!1))),C.$set(c);const f={};!I&&1&t&&(I=!0,f.resMin=e[0].SpatialConfig.BeginOutputLevel,_((()=>I=!1))),!L&&1&t&&(L=!0,f.resMax=e[0].SpatialConfig.EndOutputLevel,_((()=>L=!1))),P.$set(f)},i(e){b||(E(n.$$.fragment,e),E(o.$$.fragment,e),E(m.$$.fragment,e),E(x.$$.fragment,e),E(S.$$.fragment,e),E(C.$$.fragment,e),E(P.$$.fragment,e),E(z.$$.fragment,e),b=!0)},o(e){V(n.$$.fragment,e),V(o.$$.fragment,e),V(m.$$.fragment,e),V(x.$$.fragment,e),V(S.$$.fragment,e),V(C.$$.fragment,e),V(P.$$.fragment,e),V(z.$$.fragment,e),b=!1},d(e){e&&l(t),F(n),F(o),F(m),F(x),F(S),F(C),F(P),F(z)}}}function oe(e,t,n){let{res:i}=t;return i||(i={}),i.DatasetConfig={},i.DatasetConfig.InputEncoding={BitDepth:16,Encoding:0,Gamma:1,SwapEndian:!0},i.DatasetConfig.OutputEncoding={BitDepth:16,Encoding:0,Gamma:1,SwapEndian:!1},i.SpatialConfig={},i.SpatialConfig.OutputPixelOffset=[0,0],e.$$set=e=>{"res"in e&&n(0,i=e.res)},[i,function(t){e.$$.not_equal(i.DatasetConfig.InputURIFormat,t)&&(i.DatasetConfig.InputURIFormat=t,n(0,i))},function(t){e.$$.not_equal(i.DatasetConfig.OutputURIFormat,t)&&(i.DatasetConfig.OutputURIFormat=t,n(0,i))},function(t){e.$$.not_equal(i.SpatialConfig.OutputPixelRange,t)&&(i.SpatialConfig.OutputPixelRange=t,n(0,i))},function(t){e.$$.not_equal(i.SpatialConfig.OutputTileSize,t)&&(i.SpatialConfig.OutputTileSize=t,n(0,i))},function(t){e.$$.not_equal(i.SpatialConfig.InputTileSize,t)&&(i.SpatialConfig.InputTileSize=t,n(0,i))},function(t){e.$$.not_equal(i.SpatialConfig.OutputToInputPixelRatio,t)&&(i.SpatialConfig.OutputToInputPixelRatio=t,n(0,i))},function(t){e.$$.not_equal(i.SpatialConfig.BeginOutputLevel,t)&&(i.SpatialConfig.BeginOutputLevel=t,n(0,i))},function(t){e.$$.not_equal(i.SpatialConfig.EndOutputLevel,t)&&(i.SpatialConfig.EndOutputLevel=t,n(0,i))}]}class se extends N{constructor(e){super(),U(this,e,oe,ae,o,{res:0})}}function ue(t){let n,i,a,o,x,h,v,S;return{c(){n=r("div"),i=r("div"),a=p(t[1]),o=c(),x=r("div"),h=r("input"),g(i,"class","name"),g(h,"type","number"),g(h,"min",t[2]),g(h,"max",t[3]),g(n,"class","holder svelte-17wter4")},m(e,l){u(e,n,l),s(n,i),s(i,a),s(n,o),s(n,x),s(x,h),$(h,t[0]),v||(S=f(h,"input",t[4]),v=!0)},p(e,[t]){2&t&&d(a,e[1]),4&t&&g(h,"min",e[2]),8&t&&g(h,"max",e[3]),1&t&&m(h.value)!==e[0]&&$(h,e[0])},i:e,o:e,d(e){e&&l(n),v=!1,S()}}}function le(e,t,n){let{name:i}=t,{res:a}=t,{min:o}=t,{max:s}=t;return a||(a=0),e.$$set=e=>{"name"in e&&n(1,i=e.name),"res"in e&&n(0,a=e.res),"min"in e&&n(2,o=e.min),"max"in e&&n(3,s=e.max)},[a,i,o,s,function(){a=m(this.value),n(0,a)}]}class re extends N{constructor(e){super(),U(this,e,le,ue,o,{name:1,res:0,min:2,max:3})}}function pe(t){let n,i,a,o,m,$,x;return{c(){n=r("label"),i=r("div"),a=p(t[1]),o=c(),m=r("input"),g(i,"class","name"),g(m,"id",t[2]()),g(m,"type","checkbox"),g(m,"class","svelte-o1ligv"),g(n,"for",t[2]()),g(n,"class","holder svelte-o1ligv")},m(e,l){u(e,n,l),s(n,i),s(i,a),s(n,o),s(n,m),m.checked=t[0],$||(x=f(m,"change",t[3]),$=!0)},p(e,[t]){2&t&&d(a,e[1]),1&t&&(m.checked=e[0])},i:e,o:e,d(e){e&&l(n),$=!1,x()}}}function ce(e,t,n){let{name:i}=t,{res:a}=t;return e.$$set=e=>{"name"in e&&n(1,i=e.name),"res"in e&&n(0,a=e.res)},[a,i,()=>`id_${i}`,function(){a=this.checked,n(0,a)}]}class fe extends N{constructor(e){super(),U(this,e,ce,pe,o,{name:1,res:0})}}function ge(e){let t,n,i,a,o,p,f,g,m,d,$,x,h;function v(t){e[6](t)}let S={name:"Preview Output Level",min:e[4],max:e[5]};function w(t){e[7](t)}void 0!==e[0]&&(S.res=e[0]),n=new re({props:S}),O.push((()=>k(n,"res",v)));let y={name:"Show Pixel Range"};function C(t){e[8](t)}void 0!==e[3]&&(y.res=e[3]),o=new fe({props:y}),O.push((()=>k(o,"res",w)));let T={name:"Show Input Tiles"};function R(t){e[9](t)}void 0!==e[1]&&(T.res=e[1]),g=new fe({props:T}),O.push((()=>k(g,"res",C)));let P={name:"Show Output Tiles"};return void 0!==e[2]&&(P.res=e[2]),$=new fe({props:P}),O.push((()=>k($,"res",R))),{c(){t=r("div"),q(n.$$.fragment),a=c(),q(o.$$.fragment),f=c(),q(g.$$.fragment),d=c(),q($.$$.fragment)},m(e,i){u(e,t,i),D(n,t,null),s(t,a),D(o,t,null),s(t,f),D(g,t,null),s(t,d),D($,t,null),h=!0},p(e,[t]){const a={};16&t&&(a.min=e[4]),32&t&&(a.max=e[5]),!i&&1&t&&(i=!0,a.res=e[0],_((()=>i=!1))),n.$set(a);const s={};!p&&8&t&&(p=!0,s.res=e[3],_((()=>p=!1))),o.$set(s);const u={};!m&&2&t&&(m=!0,u.res=e[1],_((()=>m=!1))),g.$set(u);const l={};!x&&4&t&&(x=!0,l.res=e[2],_((()=>x=!1))),$.$set(l)},i(e){h||(E(n.$$.fragment,e),E(o.$$.fragment,e),E(g.$$.fragment,e),E($.$$.fragment,e),h=!0)},o(e){V(n.$$.fragment,e),V(o.$$.fragment,e),V(g.$$.fragment,e),V($.$$.fragment,e),h=!1},d(e){e&&l(t),F(n),F(o),F(g),F($)}}}function me(e,t,n){let{previewOutputLevel:i}=t,{showInputTiles:a}=t,{showOutputTiles:o}=t,{showPixelRange:s}=t,{levelMin:u}=t,{levelMax:l}=t;return e.$$set=e=>{"previewOutputLevel"in e&&n(0,i=e.previewOutputLevel),"showInputTiles"in e&&n(1,a=e.showInputTiles),"showOutputTiles"in e&&n(2,o=e.showOutputTiles),"showPixelRange"in e&&n(3,s=e.showPixelRange),"levelMin"in e&&n(4,u=e.levelMin),"levelMax"in e&&n(5,l=e.levelMax)},[i,a,o,s,u,l,function(e){i=e,n(0,i)},function(e){s=e,n(3,s)},function(e){a=e,n(1,a)},function(e){o=e,n(2,o)}]}class de extends N{constructor(e){super(),U(this,e,me,ge,o,{previewOutputLevel:0,showInputTiles:1,showOutputTiles:2,showPixelRange:3,levelMin:4,levelMax:5})}}function $e(e){let t,n,i,a,o,m,d,$,h,v,S,w,y,C,T,R,P,I,L,M,z,b;function B(t){e[4](t)}let U={};function N(t){e[5](t)}function A(t){e[6](t)}function X(t){e[7](t)}function j(t){e[8](t)}void 0!==e[0]&&(U.res=e[0]),o=new se({props:U}),O.push((()=>k(o,"res",B)));let H={levelMin:e[0].BeginOutputLevel,levelMax:e[0].EndOutputLevel};return void 0!==e[1].previewOutputLevel&&(H.previewOutputLevel=e[1].previewOutputLevel),void 0!==e[1].showPixelRange&&(H.showPixelRange=e[1].showPixelRange),void 0!==e[1].showInputTiles&&(H.showInputTiles=e[1].showInputTiles),void 0!==e[1].showOutputTiles&&(H.showOutputTiles=e[1].showOutputTiles),T=new de({props:H}),O.push((()=>k(T,"previewOutputLevel",N))),O.push((()=>k(T,"showPixelRange",A))),O.push((()=>k(T,"showInputTiles",X))),O.push((()=>k(T,"showOutputTiles",j))),{c(){t=r("main"),n=r("canvas"),i=c(),a=r("div"),q(o.$$.fragment),d=c(),$=r("button"),h=p(xe),v=c(),S=r("input"),y=c(),C=r("div"),q(T.$$.fragment),g(n,"id","myCanvas"),g(n,"class","svelte-1v4pyzs"),g($,"class","executeButton svelte-1v4pyzs"),x($,"background-color",e[2](xe)),g(S,"type","text"),S.value=w=JSON.stringify(e[0]),S.readOnly=!0,g(a,"class","leftBlock svelte-1v4pyzs"),g(C,"class","leftBlock svelte-1v4pyzs"),g(t,"class","svelte-1v4pyzs")},m(l,r){u(l,t,r),s(t,n),s(t,i),s(t,a),D(o,a,null),s(a,d),s(a,$),s($,h),s(a,v),s(a,S),s(t,y),s(t,C),D(T,C,null),M=!0,z||(b=f($,"click",e[3]),z=!0)},p(e,[t]){const n={};!m&&1&t&&(m=!0,n.res=e[0],_((()=>m=!1))),o.$set(n),(!M||1&t&&w!==(w=JSON.stringify(e[0]))&&S.value!==w)&&(S.value=w);const i={};1&t&&(i.levelMin=e[0].BeginOutputLevel),1&t&&(i.levelMax=e[0].EndOutputLevel),!R&&2&t&&(R=!0,i.previewOutputLevel=e[1].previewOutputLevel,_((()=>R=!1))),!P&&2&t&&(P=!0,i.showPixelRange=e[1].showPixelRange,_((()=>P=!1))),!I&&2&t&&(I=!0,i.showInputTiles=e[1].showInputTiles,_((()=>I=!1))),!L&&2&t&&(L=!0,i.showOutputTiles=e[1].showOutputTiles,_((()=>L=!1))),T.$set(i)},i(e){M||(E(o.$$.fragment,e),E(T.$$.fragment,e),M=!0)},o(e){V(o.$$.fragment,e),V(T.$$.fragment,e),M=!1},d(e){e&&l(t),F(o),F(T),z=!1,b()}}}let xe="Process Dataset";function he(e,t,n){let i={};new Audio("click.wav");let a={previewOutputLevel:0,showPixelRange:!0,showInputTiles:!0,showOutputTiles:!0};const o=()=>document.getElementById("myCanvas"),s={scale:{x:-7,y:-7},offset:{x:0,y:0},dragStart:{x:0,y:0},dragging:!1,dragOffsetStart:{x:0,y:0},cursor:{x:0,y:0},canvasSize:{x:0,y:0},toViewSpace(e,t){return{x:e*Math.pow(2,this.scale.x)+this.offset.x,y:this.canvasSize.y-1-t*Math.pow(2,this.scale.y)+this.offset.y}},toPixelSpace(e,t){return{x:(e-this.offset.x)/Math.pow(2,this.scale.x),y:(this.canvasSize.y+1-(t-this.offset.y))/Math.pow(2,this.scale.y)}}},u={logs:[],logsLastRetrieved:0,cachedTiles:[],processedTiles:[],queryNewLogs(){const e=new XMLHttpRequest;e.open("POST","/status"),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.onreadystatechange=e=>{if(e.target.readyState!=XMLHttpRequest.DONE)return;let t;try{t=JSON.parse(e.target.response)}catch(e){console.log("malformed response")}this.logsLastRetrieved=t.time,t.logs.length>0&&(this.logs=this.logs.concat(t.logs),t.logs.forEach((e=>console.log(e.content))))},e.send(JSON.stringify({beginMicros:this.logsLastRetrieved}))}},l=e=>e.toFixed(2).replace(/\.?0*$/,""),r=(e,t)=>Math.floor(e)-((e,t)=>{const n=Math.abs(Math.floor(e))%t;return Math.floor(e)<0&&n?t-n:n})(e,t),p=(e,t)=>r(e,t)+t,c=(e,t)=>{const n=t.getContext("2d");t.width=window.innerWidth,t.height=window.innerHeight,s.canvasSize={x:t.width,y:t.height},n.font="14px Consolas, monaco, monospace",n.lineWidth=1;const i=s.toPixelSpace(s.cursor.x,s.cursor.y),o=(e,t,i,a="#fff")=>{const o=s.toViewSpace(e,t);n.fillStyle=a,n.fillText(i,o.x,o.y)},u=(e,t,i,a,o="#fff")=>{n.fillStyle=o;const u=s.toViewSpace(e,t),l=s.toViewSpace(e+i,t+a);n.fillRect(u.x,u.y,l.x-u.x,l.y-u.y)},c=(e,t,i)=>{const a=s.toViewSpace(t,e),o=s.toViewSpace(i,e);n.beginPath(),n.moveTo(a.x,a.y),n.lineTo(o.x,o.y),n.stroke()},f=(e,t,i)=>{const a=s.toViewSpace(e,t),o=s.toViewSpace(e,i);n.beginPath(),n.moveTo(a.x,a.y),n.lineTo(o.x,o.y),n.stroke()},g={x:r(i.x,e.SpatialConfig.InputTileSize[0])/e.SpatialConfig.InputTileSize[0],y:r(i.y,e.SpatialConfig.InputTileSize[1])/e.SpatialConfig.InputTileSize[1]},m={x:r(i.x,e.SpatialConfig.OutputTileSize[0])/e.SpatialConfig.OutputTileSize[0],y:r(i.y,e.SpatialConfig.OutputTileSize[1])/e.SpatialConfig.OutputTileSize[1]};{const e=s.toPixelSpace(s.cursor.x+6,s.cursor.y-10),a=s.toPixelSpace(s.cursor.x+6,s.cursor.y-25),u=s.toPixelSpace(s.cursor.x+6,s.cursor.y-40);n.strokeStyle="#fff4",$=i.x,n.beginPath(),n.moveTo(s.toViewSpace($,0).x,0),n.lineTo(s.toViewSpace($,0).x,t.height),n.stroke(),d=i.y,n.beginPath(),n.moveTo(0,s.toViewSpace(0,d).y),n.lineTo(t.width+1,s.toViewSpace(0,d).y),n.stroke(),o(e.x,e.y,"Pixel      : "+l(i.x)+", "+l(i.y)),o(a.x,a.y,"Input Tile : "+l(g.x)+", "+l(g.y)),o(u.x,u.y,"Output Tile: "+l(m.x)+", "+l(m.y))}var d,$;if(u(g.x*e.SpatialConfig.InputTileSize[0],g.y*e.SpatialConfig.InputTileSize[1],e.SpatialConfig.InputTileSize[0],e.SpatialConfig.InputTileSize[1],"#f884"),u(m.x*e.SpatialConfig.OutputTileSize[0],m.y*e.SpatialConfig.OutputTileSize[1],e.SpatialConfig.OutputTileSize[0],e.SpatialConfig.OutputTileSize[1],"#8f84"),u(Math.floor(i.x),Math.floor(i.y),1,1,"#ffff"),n.globalCompositeOperation="lighter",a.showInputTiles){const t=e.SpatialConfig.InputTileSize[0],i=e.SpatialConfig.InputTileSize[1],a=r(e.SpatialConfig.OutputPixelRange.min[0],t)/t,o=p(e.SpatialConfig.OutputPixelRange.max[0]-1,t)/t,s=r(e.SpatialConfig.OutputPixelRange.min[1],i)/i,u=p(e.SpatialConfig.OutputPixelRange.max[1]-1,i)/i;n.strokeStyle="#fff4";for(let e=a;e<=o;++e)f(e*t,s*i,u*i);for(let e=s;e<=u;++e)c(e*i,a*t,o*t)}if(a.showOutputTiles){const t=e.SpatialConfig.OutputTileSize[0]*Math.pow(2,a.previewOutputLevel),i=e.SpatialConfig.OutputTileSize[1]*Math.pow(2,a.previewOutputLevel),o=r(e.SpatialConfig.OutputPixelRange.min[0],t)/t,s=p(e.SpatialConfig.OutputPixelRange.max[0]-1,t)/t,u=r(e.SpatialConfig.OutputPixelRange.min[1],i)/i,l=p(e.SpatialConfig.OutputPixelRange.max[1]-1,i)/i;n.strokeStyle="#fff4";for(let e=o;e<=s;++e)f(e*t,u*i,l*i);for(let e=u;e<=l;++e)c(e*i,o*t,s*t)}n.globalCompositeOperation="source-over",a.showPixelRange&&u(e.SpatialConfig.OutputPixelRange.min[0],e.SpatialConfig.OutputPixelRange.min[1],e.SpatialConfig.OutputPixelRange.max[0]-e.SpatialConfig.OutputPixelRange.min[0],e.SpatialConfig.OutputPixelRange.max[1]-e.SpatialConfig.OutputPixelRange.min[1],"#44f3")};var f;return window.addEventListener("resize",(()=>{c(i,o())})),f=()=>{c(i,o())},S().$$.after_update.push(f),function(e){S().$$.on_mount.push(e)}((()=>{const e=o();e.addEventListener("wheel",(e=>{((e,t,n,i)=>{const a=e.toPixelSpace(n,i),o=e.toViewSpace(a.x,a.y);e.scale.x+=t,e.scale.x=Math.min(Math.max(e.scale.x,-10),10),e.scale.y=e.scale.x;const s=e.toViewSpace(a.x,a.y);e.offset.x-=s.x-o.x,e.offset.y-=s.y-o.y})(s,5e-4*e.wheelDeltaY,e.clientX,e.clientY),c(i,o())})),e.addEventListener("mousedown",(e=>{s.dragging=!0,s.dragStart.x=e.clientX,s.dragStart.y=e.clientY,s.dragOffsetStart=s.offset})),e.addEventListener("mouseup",(e=>{s.dragging=!1})),e.addEventListener("mousemove",(e=>{if(s.cursor={x:e.clientX,y:e.clientY},s.dragging){const t={x:e.clientX-s.dragStart.x,y:e.clientY-s.dragStart.y};s.offset={x:s.dragOffsetStart.x+t.x,y:s.dragOffsetStart.y+t.y}}c(i,o())})),e.addEventListener("mouseleave",(e=>{s.dragging=!1}))})),setInterval((()=>u.queryNewLogs()),250),[i,a,e=>{switch(e){case"Process Dataset":return"#060";case"Cancel":return"#700"}return"#006"},()=>{const e=new XMLHttpRequest;e.open("POST","/process"),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.send(JSON.stringify(i))},function(e){i=e,n(0,i)},function(t){e.$$.not_equal(a.previewOutputLevel,t)&&(a.previewOutputLevel=t,n(1,a))},function(t){e.$$.not_equal(a.showPixelRange,t)&&(a.showPixelRange=t,n(1,a))},function(t){e.$$.not_equal(a.showInputTiles,t)&&(a.showInputTiles=t,n(1,a))},function(t){e.$$.not_equal(a.showOutputTiles,t)&&(a.showOutputTiles=t,n(1,a))}]}return new class extends N{constructor(e){super(),U(this,e,he,$e,o,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
